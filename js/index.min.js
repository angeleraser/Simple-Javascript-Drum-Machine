const bank = [
  {
    keyCode: 81,
    keyTrigger: "Q",
    id: "Heater-1",
    url: "https://s3.amazonaws.com/freecodecamp/drums/Heater-1.mp3",
  },
  {
    keyCode: 87,
    keyTrigger: "W",
    id: "Heater-2",
    url: "https://s3.amazonaws.com/freecodecamp/drums/Heater-2.mp3",
  },
  {
    keyCode: 69,
    keyTrigger: "E",
    id: "Heater-3",
    url: "https://s3.amazonaws.com/freecodecamp/drums/Heater-3.mp3",
  },
  {
    keyCode: 65,
    keyTrigger: "A",
    id: "Heater-4",
    url: "https://s3.amazonaws.com/freecodecamp/drums/Heater-4_1.mp3",
  },
  {
    keyCode: 83,
    keyTrigger: "S",
    id: "Clap",
    url: "https://s3.amazonaws.com/freecodecamp/drums/Heater-6.mp3",
  },
  {
    keyCode: 68,
    keyTrigger: "D",
    id: "Open-HH",
    url: "https://s3.amazonaws.com/freecodecamp/drums/Dsc_Oh.mp3",
  },
  {
    keyCode: 90,
    keyTrigger: "Z",
    id: "Kick-n'-Hat",
    url: "https://s3.amazonaws.com/freecodecamp/drums/Kick_n_Hat.mp3",
  },
  {
    keyCode: 88,
    keyTrigger: "X",
    id: "Kick",
    url: "https://s3.amazonaws.com/freecodecamp/drums/RP4_KICK_1.mp3",
  },
  {
    keyCode: 67,
    keyTrigger: "C",
    id: "Closed-HH",
    url: "https://s3.amazonaws.com/freecodecamp/drums/Cev_H2.mp3",
  },
];
const padBank = document.querySelector("#pad-bank"),
  display = document.querySelector("#display "),
  keyCodes = bank.map(({ keyCode }) => keyCode),
  audioNames = bank.map(({ id }) => id),
  drumPads = Array.from(padBank.querySelectorAll(".drum-pad")).map(
    (el, index) => ({
      el,
      keyCode: keyCodes[index],
      audioName: audioNames[index],
    })
  );
const DrumMachine = {
  bankSource: bank,
  padBank,
  pads: drumPads,
  display,
  onPadEventListener() {
    this.initializePadElements();
    this.onClick();
    this.onKeyUp();
    this.onKeydown();
  },
  initializePadElements() {
    this.bankSource.forEach((source, sIndex) => {
      const pad = this.pads[sIndex].el,
        audioEl = pad.querySelector("audio");
      pad.id = source.id;
      audioEl.src = source.url;
      audioEl.id = source.keyTrigger;
    });
  },
  onKeydown() {
    document.addEventListener("keydown", ({ keyCode }) => {
      if (keyCodes.some((kc) => kc === keyCode)) {
        const { el: pad, audioName } = this.pads.find(
          (pad) => pad.keyCode === keyCode
        );
        pad.classList.add("active");
        this.changeDisplayText(audioName);
      }
    });
  },
  onKeyUp() {
    document.addEventListener("keyup", ({ keyCode }) => {
      if (keyCodes.some((kc) => kc === keyCode)) {
        const { el: pad } = this.pads.find((pad) => pad.keyCode === keyCode),
          audio = pad.querySelector("audio");
        pad.classList.remove("active");
        this.playAudio(audio);
      }
    });
  },
  onClick() {
    this.padBank.addEventListener("click", ({ target }) => {
      const audio = target.querySelector("audio");
      this.changeDisplayText(target.id)
      this.playAudio(audio);
    });
  },
  playAudio(audio) {
    audio.currentTime = 0;
    audio.play();
  },
  changeDisplayText(value) {
    this.display.textContent = value;
  },
};
DrumMachine.onPadEventListener();